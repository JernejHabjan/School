<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>nalogaJS</title>

    <script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>


    <style>
        ul#list li.item:hover {
            text-decoration: line-through;
            background-color: yellow;
        }


        ul#list li.item-black {
            color: black;
        }

        ul#list li.item-red {
            color: red;
        }

        ul#list li.item-blue {
            color: blue;
        }
    </style>
</head>
<body>
    <main>
        <div style="border: 1px solid black; ">
            <h3 style="color:green">dodaj nov element na seznam opravil</h3><br>
            <dl>
                <dt>Vsebina:</dt>
                <dd><input id="todoContent" placeholder="Tukaj vnesi vsebino TODOja." /></dd>

                <dt>Barva:</dt>
                <dd>
                    <select id="todoColor">
                        <option value="black">Črna</option>
                        <option value="red">Rdeča</option>
                        <option value="blue">Modra</option>
                    </select>
                </dd>

                <dt></dt>
                <dd>&nbsp;</dd>

                <dt></dt>
                <dd><button id="addButton">Dodaj</button></dd>
            </dl>
        </div>

        <div id ="place" style="min-height: 100px; border:1px solid black">
            <h2 id="opravila">Ni opravil</h2>
            <ul id="list">
            </ul>
        </div>

        <script>
            var TODO = (function() {
                /*
                 * Inicializiramo našo instanco.
                 */
                function TODO() {
                    var self = this;
                    this.todoList = [];

                    // Pripnemo event listenerje na ustrezne elemente.
                    $('#addButton').click(function () {
                        var content = $('#todoContent').val();
                        var color = $('#todoColor').val();
                        // Dodamo element na seznam TODOjev.
                        self.add(content, color);
                        // Resetiramo vsebino vmesnika za dodajanje.
                        $('#todoContent').val('');
                        // Fokus ponovno na element za vnos vsebine.
                        $('#todoContent').focus();

                    });

                    $('#todoContent').keypress(function (event) {
                        // Zanimajo nas samo pritiski na tipko enter.
                        if (event.which != 13)
                            return;

                        event.preventDefault();
                        $('#addButton').click();
                    });
                    // Fokusiramo polje za vnos novega TODOja.
                    $('#todoContent').focus();

                    this.render();
                }

                TODO.prototype.add = function (text, color) {
                    this.todoList.push({
                        content:text,
                        color:color
                    });
                    this.render();
                };

                TODO.prototype.remove = function (index) {
                    if (index < this.todoList.length) {
                        this.todoList.splice(index, 1);
                    }

                    this.render();
                };

                TODO.prototype.render = function () {
                    var self = this;
                    var container = $('#list');
                    container.empty();
                    if (this.todoList.length > 0) {
                        // Narišemo ustrezne elemente.
                        for (var index = 0; index < this.todoList.length; index++) {
                            var item = this.todoList[index];
                            console.log('<li class="item item-' + item.color + '">' + item.content + '</li>');
                            var renderedItem = $('<li class="item item-' + item.color + '">' + item.content + '</li>');


                            //remove
                            (function (index) {
                                renderedItem.click(function () {
                                    self.remove(index);
                                });
                            })(index);
                            //end remove


                            container.append(renderedItem);
                        }
                    }else {
                        // Dodamo sporočilo, da na seznamu ni nobenih opravil.
                        container.append('<li class="message">Na seznamu ni nobenih opravil.</li>');
                    }
                };

                return TODO;
            })();

            // Kreiramo instanco našega TODOja.
            $(document).ready(function () {
                var todo = new TODO();
            });

        </script>

    </main>
</body>
</html>